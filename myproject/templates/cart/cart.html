{% extends 'base.html' %}
{% load static %}
{% block title %}Корзина — Восточный Лист{% endblock %}
{% block content %}
<section class="section" style="padding-top: 6rem;">
    <div class="container">
        <h1 class="section-title">Корзина покупок</h1>
        {% if cart.items.exists %}
        <div class="cart-page-list" style="margin-bottom:2rem;">
            {% for item in cart.items.all %}
            <div class="cart-item" style="display:flex; align-items:center; gap:1rem; padding:1.5rem 0; border-bottom:1px solid var(--border-light);">
                <div class="cart-item-image" style="width:80px; height:80px; background:var(--cream); border-radius:var(--radius); display:flex; align-items:center; justify-content:center;">
                    {% if item.product.image %}
                    <img src="{{ item.product.image.url }}" alt="" style="width:100%; height:100%; object-fit:cover; border-radius:var(--radius);">
                    {% else %}
                    <i class="fas fa-leaf" style="font-size:2rem; color:var(--text-light);"></i>
                    {% endif %}
                </div>
                <div style="flex:1;">
                    <a href="{{ item.product.get_absolute_url }}" style="font-weight:600; color:inherit; text-decoration:none;">{{ item.product.name }}</a>
                    <p style="margin:0.25rem 0 0; color:var(--text-secondary);">{{ item.product.price }} ₽ × {{ item.quantity }} = {{ item.total_price }} ₽</p>
                </div>
                <form action="{% url 'cart:remove_from_cart' item.id %}" method="post" style="margin:0;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-small" style="background:var(--error); color:white; border:none;">Удалить</button>
                </form>
            </div>
            {% endfor %}
        </div>
        <div class="cart-total-box" style="background:var(--cream); padding:1.5rem; border-radius:var(--radius); max-width:400px;">
            <p style="font-size:1.25rem; margin-bottom:0.5rem;">Товаров в корзине: <strong>{{ cart.total_items }}</strong></p>
            <p style="font-size:1.5rem; margin:0;">Итого: <strong class="product-price">{{ cart.total_price }} ₽</strong></p>
            <a href="{% url 'products:catalog' %}" class="btn btn-secondary" style="margin-top:1rem;">Продолжить покупки</a>
            <button type="button" class="btn btn-primary" style="margin-top:0.5rem; margin-left:0.5rem;" disabled>Оформить заказ (скоро)</button>
        </div>
        {% else %}
        <div class="cart-empty-page" style="text-align:center; padding:4rem 2rem;">
            <i class="fas fa-shopping-cart" style="font-size:4rem; color:var(--text-light); margin-bottom:1rem;"></i>
            <p style="font-size:1.25rem; margin-bottom:1.5rem;">Корзина пуста</p>
            <a href="{% url 'products:catalog' %}" class="btn btn-primary">Перейти в каталог</a>
        </div>
        {% endif %}
    </div>
</section>
{% endblock %}
